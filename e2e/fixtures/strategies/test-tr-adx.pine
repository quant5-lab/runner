//@version=5
indicator("TR ADX", overlay=false)

// Test: Custom ADX calculation using TR
dirmov(len) =>
    up = ta.change(high)
    down = -ta.change(low)
    trur = ta.rma(tr, len)
    plus = 100 * ta.rma(up > down and up > 0 ? up : 0, len) / trur
    minus = 100 * ta.rma(down > up and down > 0 ? down : 0, len) / trur
    [plus, minus]

adx(dilen, adxlen) =>
    [plus, minus] = dirmov(dilen)
    sum = plus + minus
    100 * ta.rma(math.abs(plus - minus) / (sum == 0 ? 1 : sum), adxlen)

[diplus, diminus] = dirmov(14)
adx_value = adx(14, 14)

plot(adx_value, "ADX", color=color.blue)
plot(diplus, "DI+", color=color.green)
plot(diminus, "DI-", color=color.red)
