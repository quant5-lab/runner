services:
  runner:
    build:
      context: ..
      dockerfile: runner/Dockerfile
    image: runner-app
    container_name: runner-dev
    volumes:
      - ./src:/app/src
      - ./services:/app/services
      - ./strategies:/app/strategies
      - ./tests:/app/tests
      - ./e2e:/app/e2e
      - ./scripts:/app/scripts
      - ./package.json:/app/package.json
      - ./pnpm-lock.yaml:/app/pnpm-lock.yaml
      - ./vitest.config.js:/app/vitest.config.js
      - ./out:/app/out
      - ../PineTS:/PineTS:ro
    environment:
      - SYMBOL=${SYMBOL:-BTCUSDT}
      - TIMEFRAME=${TIMEFRAME:-1h}
      - BARS=${BARS:-100}
      - STRATEGY=${STRATEGY:-}
    command: sh -c "npx http-server out -p 8080 -c-1 & tail -f /dev/null"
    ports:
      - '8080:8080'
    networks:
      - runner-net

networks:
  runner-net:
    driver: bridge
